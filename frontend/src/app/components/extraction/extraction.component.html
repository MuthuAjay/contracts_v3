<div class="extraction-container">
    <div class="header">
        <h2>Information Extraction Results</h2>
        <button (click)="refreshData()" class="refresh-btn">
            <span class="material-icons">refresh</span>
            Refresh Data
        </button>
    </div>

    <div *ngIf="loading" class="loading-indicator">
        <div class="spinner"></div>
        <p>Loading extraction data...</p>
    </div>

    <div *ngIf="!loading && error" class="error-message">
        <p>{{ error }}</p>
    </div>

    <div *ngIf="!loading && !error && extractionData.length === 0" class="no-data">
        <p>No extraction data available. Please run an extraction analysis first.</p>
    </div>

    <div *ngIf="!loading && !error && extractionData.length > 0" class="two-column-layout">
        <!-- Left Column - Categories -->
        <div class="categories-column">
            <div *ngFor="let category of categories" 
                 class="category-item" 
                 [class.active]="isSectionExpanded(category)"
                 [class.empty]="!hasCategoryResults(category)"
                 (click)="toggleSection(category)">
                <span class="category-name">{{ category }}</span>
                <div class="section-badge" *ngIf="getResultsForCategory(category).length > 0">
                    {{ getResultsForCategory(category).length }}
                </div>
            </div>
        </div>

        <!-- Right Column - Section Table -->
        <div class="table-column">
            <ng-container *ngFor="let category of categories">
                <div *ngIf="isSectionExpanded(category)" class="section-table" [@expandCollapse]>
                    <h3>{{ category }}</h3>
                    <table class="data-table" *ngIf="hasCategoryResults(category)">
                        <thead>
                            <tr>
                                <th>Term</th>
                                <th>Value</th>
                                <th>Last Updated</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of getResultsForCategory(category)">
                                <td class="term-cell">{{ item.term }}</td>
                                <td class="value-cell">{{ item.extracted_value }}</td>
                                <td class="timestamp-cell">{{ item.timestamp | date:'medium' }}</td>
                            </tr>
                        </tbody>
                    </table>
                    <div *ngIf="!hasCategoryResults(category)" class="empty-category">
                        <p>No data available for this section.</p>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>
</div>